1                                                          The SAS System                            10:40 Tuesday, January 12, 2016

NOTE: Copyright (c) 2002-2012 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M0) 
      Licensed to UNIVERSITY OF GUELPH, Site 70095643.
NOTE: This session is executing on the Linux 3.6.11-4.fc16.x86_64 (LIN X64) platform.



NOTE: Updated analytical products:
      
      SAS/STAT 12.3 (maintenance)
      SAS/ETS 12.3 (maintenance)
      SAS/OR 12.3 (maintenance)
      SAS/IML 12.3 (maintenance)
      SAS/QC 12.3 (maintenance)

NOTE: Additional host information:

 Linux LIN X64 3.6.11-4.fc16.x86_64 #1 SMP Tue Jan 8 20:57:42 UTC 2013 x86_64 Fedora release 16 (Verne) 

You are running SAS 9. Some SAS 8 files will be automatically converted 
by the V9 engine; others are incompatible.  Please see 
http://support.sas.com/rnd/migration/planning/platform/64bit.html

PROC MIGRATE will preserve current SAS file attributes and is 
recommended for converting all your SAS libraries from any 
SAS 8 release to SAS 9.  For details and examples, please see
http://support.sas.com/rnd/migration/index.html


This message is contained in the SAS news file, and is presented upon
initialization.  Edit the file "news" in the "misc/base" directory to
display site-specific news and information in the program log.
The command line option "-nonews" will prevent this display.




NOTE: SAS initialization used:
      real time           0.03 seconds
      cpu time            0.02 seconds
      
1          options linesize=80;
2          
3          title 'Predicting the timecourse of ruminal pH from continuous
3        ! reticular pH measurements';
4          /*
5              D.J. Seymour*, K.M. Wood†, J.P. Cant* and G.B. Penner†
6              * Department of Animal Biosciences, University of Guelph, Guelph,
6        !  ON, N1G
7                  2W1
8              † Department of Animal & Poultry Science, University of
8        ! Saskatchewan,
9                  Saskatoon, SK, S7N 5A8
10         */
11         
12         data ph;
13             infile '~/ph/ph.dat';
14             input date_time animal day silage dmi time tc rumenph reticph;
2                                The SAS System  10:40 Tuesday, January 12, 2016

15             format date_time datetime16.;
16         
17         /*  generate predictions of reticph (Preticph) */
18         

NOTE: The infile '~/ph/ph.dat' is:
      Filename=/home/seymourd/ph/ph.dat,
      Owner Name=seymourd,Group Name=seymourd,
      Access Permission=-rw-r-----,
      Last Modified=Thu Jan  7 08:51:46 2016,
      File Size (bytes)=1181202

NOTE: 17280 records were read from the infile '~/ph/ph.dat'.
      The minimum record length was 40.
      The maximum record length was 71.
NOTE: The data set WORK.PH has 17280 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

19         proc transreg data=ph noprint;
20             title2 'Prediction of Reticular pH Using Smoothing Spline';
21             by animal;
22             model identity(reticph) = pspline(tc / nknots=44);
23             output out=transreg predicted residual;
24         run;

NOTE: 864 observations were deleted from the analysis due to missing values.
NOTE: Passive observations are beyond the exterior knots.  If you want to 
      interpolate beyond the data, specify exterior knots beyond the passive 
      observation values.
NOTE: Algorithm converged.
NOTE: The above message was for the following BY group:
      animal=52
NOTE: 30 observations were deleted from the analysis due to missing values.
NOTE: Algorithm converged.
NOTE: The above message was for the following BY group:
      animal=138
NOTE: There were 17280 observations read from the data set WORK.PH.
NOTE: The data set WORK.TRANSREG has 17280 observations and 104 variables.
NOTE: PROCEDURE TRANSREG used (Total process time):
      real time           0.20 seconds
      cpu time            0.20 seconds
      

25         
26         /*  generate lagged variables & merge TRANSREG output with original
26       ! data*/
27         /*  note on nomenclature:
28         /*      - predicted values are prefixed with P
29         /*      - residuals are prefixed with R
30         /*      - lag variables are named in the style 'lag1p/r' to denote 1
30       ! lag of the
31         /*          predicted or residual value of reticph */
32         
33         data merged;
34             merge transreg ph;
3                                The SAS System  10:40 Tuesday, January 12, 2016

35             by animal tc;
36             lag1p = lag1(Preticph);
37             lag3p = lag3(Preticph);
38             lag2r = lag2(Rreticph);
39             lag4r = lag4(Rreticph);
40             lag7r = lag7(Rreticph);
41             lag9r = lag9(Rreticph);
42             keep date_time animal day silage dmi time tc reticph Preticph
42       ! Rreticph
43                 rumenph lag1p lag3p lag2r lag4r lag7r lag9r;
44         run;

NOTE: There were 17280 observations read from the data set WORK.TRANSREG.
NOTE: There were 17280 observations read from the data set WORK.PH.
NOTE: The data set WORK.MERGED has 17280 observations and 17 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

45         
46         /*  model rumen ph based on reticular ph predictions and residuals */
47         
48         proc mixed data=merged covtest noitprint ic;
49             title2 'Prediction of Rumen pH Using Predicted Reticular pH';
50             class animal day silage;
51             model rumenph = reticph lag1p lag2r lag7r lag9r silage / solution
52                 outp=mixed;
53             random intercept Preticph lag1p lag2r lag7r lag9r / type=un
54                 subject=animal*day;
55         run;

NOTE: 976 observations are not included because of missing values.
NOTE: The data set WORK.MIXED has 17280 observations and 24 variables.
NOTE: The PROCEDURE MIXED printed pages 1-3.
NOTE: PROCEDURE MIXED used (Total process time):
      real time           7:12.55
      cpu time            7:03.10
      

56         
57         /*  prepare data for cross-validation of model */
58         /*  adapted from Cassel (2007) */
59         
60         data mixed;
61             set mixed;
62             Prumenph = Pred;
63             Rrumenph = Resid;
64             drop Pred Resid Alpha DF Upper Lower;
65             file 'mixed.dat';
66             put date_time animal day silage dmi time tc reticph Preticph
66       ! Rreticph
67                 rumenph Prumenph Rrumenph lag1p lag3p lag2r lag4r lag7r lag9r
67       ! ;
68         
69         /*  perform 10-fold cross validation */
70         /*  generate list of animal-day subsets */
71         
4                                The SAS System  10:40 Tuesday, January 12, 2016


NOTE: The file 'mixed.dat' is:
      Filename=/home/seymourd/ph/final/mixed.dat,
      Owner Name=seymourd,Group Name=seymourd,
      Access Permission=-rw-r-----,
      Last Modified=Tue Jan 12 10:47:39 2016

NOTE: 17280 records were written to the file 'mixed.dat'.
      The minimum record length was 94.
      The maximum record length was 207.
NOTE: There were 17280 observations read from the data set WORK.MIXED.
NOTE: The data set WORK.MIXED has 17280 observations and 20 variables.
NOTE: DATA statement used (Total process time):
      real time           0.09 seconds
      cpu time            0.05 seconds
      

72         proc summary data = mixed;
73             title2 'Generation of Animal-Day Subsets';
74             by animal day;
75             output out= aniday;
76         run;

NOTE: There were 17280 observations read from the data set WORK.MIXED.
NOTE: The data set WORK.ANIDAY has 60 observations and 4 variables.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

77         
78         data aniday;
79             set aniday;
80             drop _TYPE_ _FREQ_;
81             if animal = 52 and day > 12 then delete;
82         run;

NOTE: There were 60 observations read from the data set WORK.ANIDAY.
NOTE: The data set WORK.ANIDAY has 57 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

83         
84         /*  generate cross-validation datasets */
85         /*  always manually select seed for repeatability */
86         
87         %let K=10;
88         %let rate=%sysevalf((&K-1)/&K);
89         
90         proc surveyselect data=aniday out=train seed=495857 samprate=&RATE
90       ! outall
91             rep=10;
92             title2 'Selection of Training & Testing Datasets';
93         run;

NOTE: The data set WORK.TRAIN has 570 observations and 4 variables.
5                                The SAS System  10:40 Tuesday, January 12, 2016

NOTE: The PROCEDURE SURVEYSELECT printed page 4.
NOTE: PROCEDURE SURVEYSELECT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

94         
95         proc sort data = train;
96             by animal day;
97         

NOTE: There were 570 observations read from the data set WORK.TRAIN.
NOTE: The data set WORK.TRAIN has 570 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

98         data train1 train2 train3 train4 train5 train6 train7 train8 train9
98       ! train10;
99             set train;
100            if replicate = 1 then output train1;
101            if replicate = 2 then output train2;
102            if replicate = 3 then output train3;
103            if replicate = 4 then output train4;
104            if replicate = 5 then output train5;
105            if replicate = 6 then output train6;
106            if replicate = 7 then output train7;
107            if replicate = 8 then output train8;
108            if replicate = 9 then output train9;
109            if replicate = 10 then output train10;
110        run;

NOTE: There were 570 observations read from the data set WORK.TRAIN.
NOTE: The data set WORK.TRAIN1 has 57 observations and 4 variables.
NOTE: The data set WORK.TRAIN2 has 57 observations and 4 variables.
NOTE: The data set WORK.TRAIN3 has 57 observations and 4 variables.
NOTE: The data set WORK.TRAIN4 has 57 observations and 4 variables.
NOTE: The data set WORK.TRAIN5 has 57 observations and 4 variables.
NOTE: The data set WORK.TRAIN6 has 57 observations and 4 variables.
NOTE: The data set WORK.TRAIN7 has 57 observations and 4 variables.
NOTE: The data set WORK.TRAIN8 has 57 observations and 4 variables.
NOTE: The data set WORK.TRAIN9 has 57 observations and 4 variables.
NOTE: The data set WORK.TRAIN10 has 57 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

111        
112        /*
113            merge selection results to data. errors occur when merging
113      ! multiple
114            replicates, need to make form individual datasets for each
114      ! replicate
115            and merge at end
116        */
117        
6                                The SAS System  10:40 Tuesday, January 12, 2016

118        data xv1;
119            merge train1 mixed;
120            by animal day;
121        run;

NOTE: There were 57 observations read from the data set WORK.TRAIN1.
NOTE: There were 17280 observations read from the data set WORK.MIXED.
NOTE: The data set WORK.XV1 has 17280 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

122        
123        data xv2;
124            merge train2 mixed;
125            by animal day;
126        run;

NOTE: There were 57 observations read from the data set WORK.TRAIN2.
NOTE: There were 17280 observations read from the data set WORK.MIXED.
NOTE: The data set WORK.XV2 has 17280 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

127        
128        data xv3;
129            merge train3 mixed;
130            by animal day;
131        run;

NOTE: There were 57 observations read from the data set WORK.TRAIN3.
NOTE: There were 17280 observations read from the data set WORK.MIXED.
NOTE: The data set WORK.XV3 has 17280 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

132        
133        data xv4;
134            merge train4 mixed;
135            by animal day;
136        run;

NOTE: There were 57 observations read from the data set WORK.TRAIN4.
NOTE: There were 17280 observations read from the data set WORK.MIXED.
NOTE: The data set WORK.XV4 has 17280 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

137        
138        data xv5;
139            merge train5 mixed;
7                                The SAS System  10:40 Tuesday, January 12, 2016

140            by animal day;
141        run;

NOTE: There were 57 observations read from the data set WORK.TRAIN5.
NOTE: There were 17280 observations read from the data set WORK.MIXED.
NOTE: The data set WORK.XV5 has 17280 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

142        
143        data xv6;
144            merge train6 mixed;
145            by animal day;
146        run;

NOTE: There were 57 observations read from the data set WORK.TRAIN6.
NOTE: There were 17280 observations read from the data set WORK.MIXED.
NOTE: The data set WORK.XV6 has 17280 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

147        
148        data xv7;
149            merge train7 mixed;
150            by animal day;
151        run;

NOTE: There were 57 observations read from the data set WORK.TRAIN7.
NOTE: There were 17280 observations read from the data set WORK.MIXED.
NOTE: The data set WORK.XV7 has 17280 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

152        
153        data xv8;
154            merge train8 mixed;
155            by animal day;
156        run;

NOTE: There were 57 observations read from the data set WORK.TRAIN8.
NOTE: There were 17280 observations read from the data set WORK.MIXED.
NOTE: The data set WORK.XV8 has 17280 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

157        
158        data xv9;
159            merge train9 mixed;
160            by animal day;
161        run;
8                                The SAS System  10:40 Tuesday, January 12, 2016


NOTE: There were 57 observations read from the data set WORK.TRAIN9.
NOTE: There were 17280 observations read from the data set WORK.MIXED.
NOTE: The data set WORK.XV9 has 17280 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

162        
163        data xv10;
164            merge train10 mixed;
165            by animal day;
166        run;

NOTE: There were 57 observations read from the data set WORK.TRAIN10.
NOTE: There were 17280 observations read from the data set WORK.MIXED.
NOTE: The data set WORK.XV10 has 17280 observations and 22 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

167        
168        data xv;
169            set xv1 xv2 xv3 xv4 xv5 xv6 xv7 xv8 xv9 xv10;
170            if selected then new_Prumenph = Prumenph;
171            if replicate = . then delete;
172            file 'xv.dat';
173            put replicate selected animal day silage dmi time tc reticph
173      ! Preticph
174                Rreticph rumenph Prumenph Rrumenph new_Prumenph;
175        run;

NOTE: The file 'xv.dat' is:
      Filename=/home/seymourd/ph/final/xv.dat,
      Owner Name=seymourd,Group Name=seymourd,
      Access Permission=-rw-r-----,
      Last Modified=Tue Jan 12 10:47:39 2016

NOTE: 164160 records were written to the file 'xv.dat'.
      The minimum record length was 58.
      The maximum record length was 130.
NOTE: There were 17280 observations read from the data set WORK.XV1.
NOTE: There were 17280 observations read from the data set WORK.XV2.
NOTE: There were 17280 observations read from the data set WORK.XV3.
NOTE: There were 17280 observations read from the data set WORK.XV4.
NOTE: There were 17280 observations read from the data set WORK.XV5.
NOTE: There were 17280 observations read from the data set WORK.XV6.
NOTE: There were 17280 observations read from the data set WORK.XV7.
NOTE: There were 17280 observations read from the data set WORK.XV8.
NOTE: There were 17280 observations read from the data set WORK.XV9.
NOTE: There were 17280 observations read from the data set WORK.XV10.
NOTE: The data set WORK.XV has 164160 observations and 23 variables.
NOTE: DATA statement used (Total process time):
      real time           0.51 seconds
      cpu time            0.33 seconds
      
9                                The SAS System  10:40 Tuesday, January 12, 2016


176        
177        proc sort data=xv;
178            by replicate animal day;
179        run;

NOTE: There were 164160 observations read from the data set WORK.XV.
NOTE: The data set WORK.XV has 164160 observations and 23 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.09 seconds
      cpu time            0.09 seconds
      

180        
181        /*  get predicted values for new_Prumenph in each replicate */
182        
183        proc mixed data=xv method=mivque0;
184            /* used mivque0 because of 'too many likelihoods' error */
185            by replicate;
186            class animal day silage;
187            model new_Prumenph = reticph lag1p lag2r lag7r lag9r silage /
187      ! solution
188                outp=xv_pred(where=(new_Prumenph=.));
189            random intercept Preticph lag1p lag2r lag7r lag9r / type=un
190                subject=animal*day;
191        run;

NOTE: 1488 observations are not included because of missing values.
NOTE: Variable StdErrPred already exists on file WORK.XV_PRED, using 
      StdErrPred2 instead.
NOTE: The above message was for the following BY group:
      Sample Replicate Number=1
NOTE: 1497 observations are not included because of missing values.
NOTE: The above message was for the following BY group:
      Sample Replicate Number=2
NOTE: 1488 observations are not included because of missing values.
NOTE: The above message was for the following BY group:
      Sample Replicate Number=3
NOTE: 1488 observations are not included because of missing values.
NOTE: The above message was for the following BY group:
      Sample Replicate Number=4
NOTE: 1488 observations are not included because of missing values.
NOTE: The above message was for the following BY group:
      Sample Replicate Number=5
NOTE: 1497 observations are not included because of missing values.
NOTE: The above message was for the following BY group:
      Sample Replicate Number=6
NOTE: 1497 observations are not included because of missing values.
NOTE: The above message was for the following BY group:
      Sample Replicate Number=7
NOTE: 1458 observations are not included because of missing values.
NOTE: The above message was for the following BY group:
      Sample Replicate Number=8
NOTE: 1488 observations are not included because of missing values.
NOTE: The above message was for the following BY group:
      Sample Replicate Number=9
NOTE: 1497 observations are not included because of missing values.
NOTE: The above message was for the following BY group:
10                               The SAS System  10:40 Tuesday, January 12, 2016

      Sample Replicate Number=10
NOTE: The data set WORK.XV_PRED has 14886 observations and 30 variables.
NOTE: The PROCEDURE MIXED printed pages 5-34.
NOTE: PROCEDURE MIXED used (Total process time):
      real time           1.81 seconds
      cpu time            1.78 seconds
      

192        
193        /*  summarize results of cross validation */
194        
195        data xv_pred;
196            set xv_pred;
197            if selected ne 0 then delete;
198            xv_Prumenph = Pred;
199            xv_Rrumenph = rumenph - xv_Prumenph;
200            absr = abs(xv_Rrumenph);
201            file 'xv_pred.dat';
202            put replicate date_time animal day silage dmi time tc reticph
202      ! Preticph
203                Rreticph rumenph Prumenph Rrumenph xv_Prumenph xv_Rrumenph
203      ! absr;
204        run;

NOTE: The file 'xv_pred.dat' is:
      Filename=/home/seymourd/ph/final/xv_pred.dat,
      Owner Name=seymourd,Group Name=seymourd,
      Access Permission=-rw-r-----,
      Last Modified=Tue Jan 12 10:47:41 2016

NOTE: 14400 records were written to the file 'xv_pred.dat'.
      The minimum record length was 77.
      The maximum record length was 171.
NOTE: Missing values were generated as a result of performing an operation on 
      missing values.
      Each place is given by: (Number of times) at (Line):(Column).
      112 at 199:27   112 at 200:12   
NOTE: There were 14886 observations read from the data set WORK.XV_PRED.
NOTE: The data set WORK.XV_PRED has 14400 observations and 33 variables.
NOTE: DATA statement used (Total process time):
      real time           0.07 seconds
      cpu time            0.05 seconds
      

205        
206        proc summary data=xv_pred;
207            title2 '10-Fold Cross Validation Summary';
208            title3 'MAE: Mean Absolute Error';
209            var xv_Rrumenph absr;
210            output out=summary std(xv_Rrumenph)=RMSE mean(absr)=MAE;
211        run;

NOTE: There were 14400 observations read from the data set WORK.XV_PRED.
NOTE: The data set WORK.SUMMARY has 1 observations and 4 variables.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      
11                               The SAS System  10:40 Tuesday, January 12, 2016


212        
213        proc print data=summary;
214        run;

NOTE: There were 1 observations read from the data set WORK.SUMMARY.
NOTE: The PROCEDURE PRINT printed page 35.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

215        
216        /* alternate method: prediction from reticph using PROC UCM */
217        
218        data ph;
219            set ph;
220            if reticph = . then delete;
221            if animal = 138 and date_time >= '01feb14:15:33:16'dt then delete
221      ! ;
222        run;

NOTE: There were 17280 observations read from the data set WORK.PH.
NOTE: The data set WORK.PH has 14803 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

223        
224        proc ucm data = ph;
225            title2 'UCM with Cyclical Component';
226            id date_time interval=dtmin5;
227            by animal;
228        
229            model rumenph = reticph;
230            level variance=0 noest;
231            cycle;
232            forecast print=none outfor=ucm;
233        run;

NOTE: Number of non-missing predictor values in the forecast horizon is less 
      than the value in the LEAD= option of the FORECAST statement.  The value 
      in the LEAD= option is reduced to 0.
NOTE: The above message was for the following BY group:
      animal=52
NOTE: Number of non-missing predictor values in the forecast horizon is less 
      than the value in the LEAD= option of the FORECAST statement.  The value 
      in the LEAD= option is reduced to 0.
NOTE: The above message was for the following BY group:
      animal=64
NOTE: Number of non-missing predictor values in the forecast horizon is less 
      than the value in the LEAD= option of the FORECAST statement.  The value 
      in the LEAD= option is reduced to 0.
NOTE: The above message was for the following BY group:
      animal=138
NOTE: Number of non-missing predictor values in the forecast horizon is less 
      than the value in the LEAD= option of the FORECAST statement.  The value 
12                               The SAS System  10:40 Tuesday, January 12, 2016

      in the LEAD= option is reduced to 0.
NOTE: The above message was for the following BY group:
      animal=183
NOTE: The data set WORK.UCM has 14803 observations and 24 variables.
NOTE: The PROCEDURE UCM printed pages 36-52.
NOTE: PROCEDURE UCM used (Total process time):
      real time           1.36 seconds
      cpu time            1.33 seconds
      

234        
235        data ucm;
236            set ucm;
237            file 'ucm.dat';
238            put animal date_time rumenph reticph FORECAST RESIDUAL STD;
239        run;

NOTE: The file 'ucm.dat' is:
      Filename=/home/seymourd/ph/final/ucm.dat,
      Owner Name=seymourd,Group Name=seymourd,
      Access Permission=-rw-r-----,
      Last Modified=Tue Jan 12 10:47:43 2016

NOTE: 14803 records were written to the file 'ucm.dat'.
      The minimum record length was 47.
      The maximum record length was 83.
NOTE: There were 14803 observations read from the data set WORK.UCM.
NOTE: The data set WORK.UCM has 14803 observations and 24 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.04 seconds
      

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           7:16.93
      cpu time            7:07.13
      
